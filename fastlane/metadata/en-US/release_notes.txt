Version 2 is a complete rewrite for performance and maintainability.
